<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation JS - ES</title>
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <script src="../js/bootstrap.bundle.js"></script>
    <script>
        /* avant es6 */
        /*
        var tableau = new Array('donnée', 'data', 45);
        console.log(tableau);
        */

        /* depuis es6 */
        let cars = ['Peugeot', 'Citroën', 'Ford', 'Renault'];
        console.log(cars);
        console.log(cars.length);
        console.log(cars[1]);
        console.log(cars[cars.length]);
        console.log(cars[cars.length - 1]);
        console.log('le tableau cars contient ' + cars.length + ' élément(s)');
        console.log(`
        le tableau cars contient ${cars.length} élément(s)
        cars est du type ${typeof cars}
        indéxé de ${0} à ${cars.length - 1}
        ` );

        cars[cars.length] = 'Kya';
        /* cars[25] = 'toto'; */
        console.log(cars);

        cars.push('Fiat');
        cars.push('Seat', 'Opel', 'Hyundai', 'Audi');
        console.log(cars);

        /* les tableaux sont itérables */

        /* Boucles */
        /* Pour */

        console.log('----------------- boucle for -----------------');
        for (let i = 0; i < cars.length; i++) {
            console.log(`la valeur à l'index ${i} est ${cars[i]} `);
        }

        console.log('----------------- boucle for in -----------------');
        for (let index in cars) {
            console.log(`la valeur à l'index ${index} est ${cars[index]} `);
        }

        /* depuis es6 */
        console.log('----------------- boucle for of -----------------');
        for (let value of cars) {
            console.log(`la valeur actuelle dans cars est ${value} `);
        }

        /* le for in permet aussi d'itérer sur les attributs et méthodes d'un objets */

        let obj = {
            nom: 'Duflot',
            prenom: 'Nicolas',
            age: 42,
            presentation: function () {
                return `bonjour, je m'appelle ${this.prenom} ${this.nom}, j'ai ${this.age} ans`;
            },
            toto: {
                titi: 'coucou',
                ok: 42
            }
        }

        console.log(obj.presentation());

        for (let key in obj) {
            console.log(`l'attribut ${key} contient ${obj[key]}`);
            console.log(`l'attribut ${key} est du type ${typeof obj[key]}`);
            if ('object' === typeof obj[key]) {
                for (let subKey in obj[key]) {
                    console.log(`l'attribut ${subKey} contient ${obj[key][subKey]}`);
                    console.log(`l'attribut ${subKey} est du type ${typeof obj[key][subKey]}`);
                }
            }
        }

        /* faire */
        console.log('----------------- boucle while -----------------');
        let cpt = 0;
        while (cpt < cars.length) {
            console.log(`la valeur à l'index ${cpt} est ${cars[cpt]} `);
            cpt++;
        }

        /* faire tant que */
        console.log('----------------- boucle do while -----------------');
        cpt = 0;
        do {
            console.log(`la valeur à l'index ${cpt} est ${cars[cpt]} `);
            cpt++;
        } while (cpt < cars.length)

        /* sortir d'une boucle prématurément */
        cpt = 0;
        do {
            if ('Ford' === cars[cpt]) {
                console.log(`Ford est à l'index ${cpt}`);
                break;
            }
            cpt++;
        } while (cpt < cars.length)

        /* la méthode forEach() */
        console.log('----------------- forEach() -----------------');
        let number = [1, 2, 3, 4, 5, 6];
        console.log(number);
        number.forEach(function (valeur, index, tab) {
            if (valeur % 2 === 0) {
                tab[index] = valeur * 1.2;
            } else {
                tab[index] = valeur * 1.3;
            }
        });

        console.log(number);

        /* la méthode map() */
        console.log('----------------- map() -----------------');
        number = [1, 2, 3, 4, 5, 6];
        console.log(number);
        number.map(function (valeur, index, tab) {
            if (valeur % 2 === 0) {
                tab[index] = valeur * 1.2;
            } else {
                tab[index] = valeur * 1.3;
            }
        });

        console.log(number);

        /* entries */
        for (let entry of cars.entries()) {
            console.log(entry);
            console.log(entry[0]);
            console.log(entry[1]);
        }

        /* keys */
        for (let key of cars.keys()) {
            console.log(key, cars[key]);
        }

        /* ajouter, supprimer inserrer des éléments dans un tableau */
        /* extraire la dernière valeur d'un tableau .pop() */
        let extractLast = cars.pop();
        console.log(extractLast, cars);
        /* extraire la première valeur d'un tableau .shift() */
        let extractFirst = cars.shift();
        console.log(extractFirst, cars);

        /*
        .splice() 3 utilisation
        */

        /* .splice() : 1 
            extraire une ou plusieurs donnée(s) du tableau où que ce soit
        */

        let tabRemoved = cars.splice(3, 3);
        console.log(tabRemoved, cars);

        /* .splice() : 2
        remplacer une ou plusieurs valeurs par une ou plusieurs valeurs
        */

        let tabReplaced = cars.splice(1, 3, 'Dacia', 'Alpine', 'Mazda');
        console.log(tabReplaced, cars);

        /* .splice() : 3
        inserrer une ou plusieurs valeurs 
        */

        cars.splice(1, 0, extractFirst, extractLast, tabRemoved[0], tabRemoved[1], tabRemoved[2], tabReplaced[0], tabReplaced[1], tabReplaced[2]);

        console.log(cars);

        /* copier un tableau dans un autre tableau */
        /*
        let cloneCars = cars;
        cloneCars.pop();
        console.log(cloneCars, cars);
        */

        /* slice() */
        let cloneCars = cars.slice();
        cloneCars.pop();
        console.log(cloneCars, cars);

        /* trier un tableau */

        cloneCars.sort().reverse();
        console.log(cloneCars);

        cloneCars.sort();
        console.log(cloneCars);

        let test = 'olalalala';
        console.log(test.split('').reverse().join(''));

        /* les tableaux à 2 dimensions */
        carsTest = [['Fiat', 1956], ['Kya', 1995], ['Kya', 1990]];
        console.table(carsTest);

        console.table(carsTest.sort());

        let tab2d = [['a', 'b', 'c'], [12, 13, 12, 15, 14], [10, 23, 56, 4, [1, 2, 3]]];
        console.table(tab2d);
        console.log(tab2d);
        console.table(tab2d.sort());

        /* créer une matrice devient un peu galère */
        let matrice = [
            [1, 2, 3, 4, 5],
            [12, 14, 75, 56, 42]
        ];

        console.log('parcourir la "matrice"');
        for(let value of matrice){
            let line = '';
            for(let subValue of value){
                line = `${line} ${subValue}`;
            }
            console.log(line);
        }

        console.log('--- parcourir la matrice "2d" avec .map ---------');
        matrice.map(function (value, index) {
            value.map(function (subValue, subIndex) {
                console.log(`X : ${index}, Y : ${subIndex} => ${subValue}`);
            });
        });

        /* retrouver une ou des occurence d'une valeur dans un tableau */
        
        /* la 1ère occurence .find() */
        let arrayNum = [5, 8, 12, 130, 5, 3, 44];
        let found = arrayNum.find(function(valeur){
            /*
            if(20 <= valeur){
                return valeur;
            }
            */
            return 20 <= valeur;
        });

        console.log(found);

        let foundAll = arrayNum.filter(function(element){
            /*
            if(20 <= element){
                return element;
            }
            */
            return 20 <= element;
        });

        console.log(foundAll);

        /* opérateur arrow */

        /*
        
        function(){
            //code
        }

        ()=>{
            //code
        }

        function(element){
            return 20 <= element;
        }

        (element)=> 20 <= element;
        
        */

        let foundAll2 = arrayNum.filter((element)=> 20 <= element);

        /*
        les fonction de rappel (callback functions) ou fonctions 
        anonymes génèrent des conséquences quand elles sont trop imbriqués 
        c'est à surveiller lors de l'utilisation du this d'un objet 
        dans les méthodes de l'objet
        */


        console.log(foundAll2);

        console.log('---------------- les conséquences --------------');
        let monObjet = {
            numbers: [1, 2, 56, 13, 123],
            affTab: function () {
                console.log(this);
                let _this = this;
                this.numbers.forEach(function (value) {
                    console.log(this);
                    console.log(_this);
                });
            },
            affTab2: function () {
                console.log(this);
                this.numbers.forEach( (value)=>{
                    console.log(this);
                });
            }
        };

        monObjet.affTab();
        console.log('---------------- affTab2 --------------');
        monObjet.affTab2();

        /* 
        créer un tableau avec des fruits et des légumes, avec deux fruits ou légumes en doublons 
        modifier le tableau pour que : 
            - les fruits et légumes soient triés par ordre alphabétiques
            - que les doublons soient supprimés du tableau
            - qu'on affiche un tableau des doublons et le nombre d'occurence de chaque doublons
        */

        let fruitEtLegumes = [
            'fraise',
            'bananes',
            'mangue',
            'choux',
            'mangue',
            'courgette',
            'fraise',
            'brocoli',
            'haricot',
            'mangue'
        ];

        console.log(fruitEtLegumes);
        let tabTemp = [];
        let tabDoublons = [];
        
        let tempFruit = '';

        let fruitEtLegumes3 = fruitEtLegumes.slice();

        fruitEtLegumes.sort();
        let fruitEtLegumes2 = fruitEtLegumes.slice();
        console.log(fruitEtLegumes);

        fruitEtLegumes.map(function(value){
            console.log(value);
            if(value !== tempFruit){
                tabTemp.push([value, 1]);
                tempFruit = value;
            }else{
                for(fruit of tabTemp){
                    if(fruit[0] === value ){
                        fruit[1] = fruit[1] + 1;
                    }
                }
            }
        });

        console.table(tabTemp);
        fruitEtLegumes.splice(0, fruitEtLegumes.length);

        tabTemp.map(function(value){
            fruitEtLegumes.push(value[0]);
            if(value[1] > 1){
                tabDoublons.push(value);
            }
        });

        console.log(fruitEtLegumes);
        console.table(tabDoublons);

        /* faire du sale avec un pseudo tableau "associatif" */
        let tabSale = [];
        console.log(fruitEtLegumes2);
        fruitEtLegumes2.map(function(value){
            if(tabSale[value] === undefined){
                tabSale[value] = 1;
            }else{
                tabSale[value] = tabSale[value] + 1;
            }
        });

        console.table(tabSale);

        /* faire du propre et évoluer POO en utlisant la classe Map() */

        //fruitEtLegumes3
        fruitEtLegumes3.sort();
        let legumeDoublons = new Map();
        for(value of fruitEtLegumes3){
            if(!legumeDoublons.get(value)){
                legumeDoublons.set(value, 1);
            }else{
                legumeDoublons.set(value, legumeDoublons.get(value) + 1);
            }
        }

        console.log(legumeDoublons);
        console.log(legumeDoublons.get('courgette'));

    </script>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container">
            <a class="navbar-brand" href="#">Navbar</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" href="./">Accueil</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            Introduction
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../introduction/index.html">Premiers scripts</a></li>
                            <li><a class="dropdown-item" href="../introduction/tableaux.html">Les tableaux</a></li>
                            <li><a class="dropdown-item" href="../introduction/fonctions.html">Les fonctions</a></li>
                            <li><a class="dropdown-item" href="../introduction/destructuration.html">La
                                    destructuration</a></li>
                            <li><a class="dropdown-item" href="../introduction/storage.html">Le storage</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            LE DOM
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../dom/index.html">DOM</a></li>
                            <li><a class="dropdown-item" href="../dom/dom.html">Créer dans le DOM</a></li>
                            <li><a class="dropdown-item" href="../dom/css.html">DOM & CSS</a></li>
                            <li><a class="dropdown-item" href="../dom/dataset.html">Dataset</a></li>
                        </ul>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            AJAX
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="../ajax/index.html">Les promesses</a></li>
                            <li><a class="dropdown-item" href="../ajax/fetch.html">AJAX avec Fetch()</a></li>
                            <li><a class="dropdown-item" href="../ajax/fetch-nyt.html">Fetch nyt</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="container">
        <section class="row">
            <div class="col">
                <article class="card">
                    <header class="card-header">
                        <h2>Les tableaux</h2>
                    </header>
                    <main class="card-body">
                        <p>
                            Tout est dans la console
                        </p>
                    </main>
                </article>
            </div>
        </section>
    </main>
</body>

</html>